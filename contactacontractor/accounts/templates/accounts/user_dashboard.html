{% extends 'app/base.html' %}

{% block content %}

    <h1>User Dashboard</h1>
    <div>
        <h2>Account Information</h2>
        <p>Username: {{ account.user.username }}</p>
        <p>Email: {{ account.user.email }}</p>
        <p>Balance: {{ account.balance }} €</p>
    </div>
    <div>
        <h2>Your Jobs</h2>
        {% for job in jobs %}
            <div style="border: 1px solid black;">
                <h3>Title: {{ job.title }}</h3>
                <p>Description: {{ job.description }}</p>
                {% if job.is_completed %}
                    <p>Completed</p>
                    {% if not job.is_review_written %}
                        <a href="{% url 'accounts:submit_review' job.id %}">
                            <input type="button" value="Submit a review">
                        </a>
                        <a href="{% url 'accounts:submit_dispute' job.id %}">
                            <input type="button" value="Submit a dispute">
                        </a>
                    {% endif %}
                {% else %}
                    {% if job.status == JOB_STATUS_AVAILABLE %}
                        <p>Status: Available</p>
                        <a href = "{% url 'accounts:view_quotes' job.id %}">
                            <input type="button" value="View submited quotes">
                        </a>
                    {% elif job.status == JOB_STATUS_ACCEPTED %}
                        <p>Status: Accepted</p>
                    {% elif job.status == JOB_STATUS_IN_PROGRESS %}
                        <p>Status: Pending</p>
                    {% endif %}
                {% endif %}
            </div>
        {% endfor %}
    </div>
    <div>
        <h2>Your Messages</h2>
        {% for message in messages %}
            <div style="border: 1px solid black;">
                <h3>Sender: {{ message.sender }}:</h3>
                <p>Message: {{ message.text }}</p>
                <a href="{% url 'accounts:new_reply' message.id %}"><button>Reply</button></a>
            </div>
        {% endfor %}
    </div>
    <br>
    {% if account.contractor %}
    <h1>Contractor Dashboard</h1>
        <div>
            <h2>Account Information</h2>
            <p>Username: {{ account.user.username }}</p>
            <p>Email: {{ account.user.email }}</p>
            <p>Balance: {{ account.balance }} €</p>
        </div>
        <div>
            <h2>Your Assigned Jobs</h2>
            {% for job in assigned_jobs %}
                <div style="border: 1px solid black">
                    <h3 style="text-transform: capitalize;">Title: {{ job.title }}</h3>
                    <p style="text-transform: capitalize;">Description: {{ job.description }}</p>
                    <p style="text-transform: capitalize;">Job issuer: {{ job.user.username }}</p>
                    <p style="text-transform: capitalize;">Location: {{ job.location }}</p>
                    <p style="text-transform: capitalize;">Job Type: {{ job.type }}</p>
                    <p>Budget: {{ job.budget }} €</p>
                </div>
            {% endfor %}
        </div>
        <div>
            <h2>Your Completed Jobs</h2>
            {% for job in completed_Contractor_Jobs %}
                <div style="border: 1px solid black">
                    <h3 style="text-transform: capitalize;">Title: {{ job.title }}</h3>
                    <p style="text-transform: capitalize;">Description: {{ job.description }}</p>
                    <p style="text-transform: capitalize;">Job issuer: {{ job.user.username }}</p>
                    <p style="text-transform: capitalize;">Location: {{ job.location }}</p>
                    <p style="text-transform: capitalize;">Job Type: {{ job.type }}</p>
                    <p>Budget: {{ job.budget }} €</p>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p><a href="{% url 'accounts:become_contractor' %}">Sign up</a> to be a contractor!</p>
    {% endif %}

{% endblock content %}