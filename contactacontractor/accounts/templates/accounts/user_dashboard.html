{% extends 'app/base.html' %}

{% block content %}

    <h1>User Dashboard</h1>
    <div>
        <h2>Account Information</h2>
        <p>Username: {{ account.user.username }}</p>
        <p>Email: {{ account.user.email }}</p>
        <p>Balance: {{ account.balance }} $</p>
    </div>
    <div>
        <h2>Your Jobs</h2>
        {% for job in jobs %}
            <div style="border: 1px solid black;">
                <h3>Title: {{ job.title }}</h3>
                <p>Description: {{ job.description }}</p>
                {% if job.is_completed %}
                    <p>Completed</p>
                    <a href = "/accounts/dashboard/submit-dispute/{{ job.id }}">
                        <input type="button" value="Submit a dispute">
                    </a>
                    <a href = "/accounts/dashboard/submit-review/{{ job.id }}">
                        <input type="button" value="Submit a review">
                    </a>
                {% else %}
                    <p>Status: Not Completed</p>
                    {% if job.status == JOB_STATUS_AVAILABLE %}
                        <a href = "/accounts/dashboard/view-quotes/{{ job.id }}">
                            <input type="button" value="View submited quotes">
                        </a>
                    {% endif %}
                {% endif %}
            </div>
        {% endfor %}
    </div>
    <div>
        <h2>Your Job Quotes</h2>
        {% for quote in your_job_quotes %}
            <div style="border: 1px solid black;">
                <h3>Title: {{ quote.job.title }}</h3>
                <p>Description: {{ quote.job.description }}</p>
                <p>Quote: {{ quote.price }} $</p>
                <p>Contractor: {{quote.contractor}}</p>
                {% if quote.accepted == False %}
                    <a href="{% url 'accounts:confirm_quote' quote.id %}"><button>Accept</button></a>
                {% endif %}
            </div>
        {% endfor %}
    </div>
    <div>
        <h2>Your Messages</h2>
        {% for message in messages %}
            <div style="border: 1px solid black;">
                <h3>Sender: {{ message.sender }}:</h3>
                <p>Message: {{ message.text }}</p>
                <a href="{% url 'accounts:new_reply' message.id %}"><button>Reply</button></a>
            </div>
        {% endfor %}
    </div>
    <br>
    {% if account.contractor %}
    <h1>Contractor Dashboard</h1>
        <div>
            <h2>Account Information</h2>
            <p>Username: {{ account.user.username }}</p>
            <p>Email: {{ account.user.email }}</p>
            <p>Balance: {{ account.balance }} $</p>
        </div>
        <div>
            <h2>Your Submitted Quotes</h2>
            {% for quote in your_quotes %}
                <div style="border: 1px solid black;">
                    <h3>Title: {{ quote.job.title }}</h3>
                    <p>Description: {{ quote.job.description }}</p>
                    <p>Quote: {{ quote.price }} $</p>
                    {% if quote.accepted %}
                        <p>Status: Accepted</p>
                    {% else %}
                        <p>Status: Not Accepted</p>
                    {% endif %}
                </div>
            {% endfor %}
        </div>
        <div>
            <h2>Your Assigned Jobs</h2>
            {% for job in assigned_jobs %}
                    <div style="border: 1px solid black">
                        <h3 style="text-transform: capitalize;">Title: {{ job.title }}</h3>
                        <p style="text-transform: capitalize;">Description: {{ job.description }}</p>
                        <p style="text-transform: capitalize;">Job issuer: {{ job.user.username }}</p>
                        <p style="text-transform: capitalize;">Location: {{ job.location }}</p>
                        <p style="text-transform: capitalize;">Job Type: {{ job.type }}</p>
                        <p>Budget: {{ job.budget }} $</p>
                    </div>
                {% endfor %}
        </div>
        <div>
            <h2>Your Completed Jobs</h2>
            {% for job in completed_jobs %}
                    <div style="border: 1px solid black">
                        <h3 style="text-transform: capitalize;">Title: {{ job.title }}</h3>
                        <p style="text-transform: capitalize;">Description: {{ job.description }}</p>
                        <p style="text-transform: capitalize;">Job issuer: {{ job.user.username }}</p>
                        <p style="text-transform: capitalize;">Location: {{ job.location }}</p>
                        <p style="text-transform: capitalize;">Job Type: {{ job.type }}</p>
                        <p>Budget: {{ job.budget }} $</p>
                    </div>
                {% endfor %}
        </div>
    {% else %}
        <p><a href="{% url 'accounts:become_contractor' %}">Sign up</a> to be a contractor!</p>
    {% endif %}

{% endblock content %}